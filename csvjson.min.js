/**
 * csvjson.js - A script to convert between CSV and JSON formats
 * Author: Aaron Snoswell (@aaronsnoswell, elucidatedbianry.com)
 */

var csvjson={};
(function(){function e(e){if(typeof e=="undefined")return false;return true}function t(e,t){for(var n=e.split(t=t||","),r=n.length-1,i;r>=0;r--){if(n[r].replace(/"\s+$/,'"').charAt(n[r].length-1)=='"'){if((i=n[r].replace(/^\s+"/,'"')).length>1&&i.charAt(0)=='"'){n[r]=n[r].replace(/^\s*"|"\s*$/g,"").replace(/""/g,'"')}else if(r){n.splice(r-1,2,[n[r-1],n[r]].join(t))}else n=n.shift().split(t).concat(n)}else n[r].replace(/""/g,'"')}return n}csvjson.csv2json=function(n,r){r=r||{};var i=e(r.delim)?r.delim:",";var s=n.split(/\r?\n/);var o=t(s[0],i);var u=s.slice(1,s.length);var a={};a.headers=o;a.rows=[];for(var f in u){if(u.hasOwnProperty(f)){var l=u[f];var c=t(l,i);if(l.length==0)break;var h={};for(var p in c){if(c.hasOwnProperty(p)){var d=c[p];if(!isNaN(d*1)){d=d*1}h[o[p]]=d}}a.rows.push(h)}}return a};csvjson.json2csv=function(t,n){n=n||{};var r=e(n.delim)?n.delim:",";var i=e(n.textdelim)?n.textdelim:"";if(typeof t=="string"){return null}var s="";for(var o in t.headers){if(t.headers.hasOwnProperty(o)){var u=t.headers[o];s+=i+u+i+r}}s=s.slice(0,s.length-1);s+="\n";for(var a in t.rows){if(t.rows.hasOwnProperty(a)){var f=t.rows[a];for(var o in t.headers){if(t.headers.hasOwnProperty(o)){var u=t.headers[o];var l=f[u];if(typeof l=="string"){s+=i+f[u]+i+r}else{s+=f[u]+r}}}s=s.slice(0,s.length-1);s+="\n"}}s=s.slice(0,s.length-1);return s}})()
